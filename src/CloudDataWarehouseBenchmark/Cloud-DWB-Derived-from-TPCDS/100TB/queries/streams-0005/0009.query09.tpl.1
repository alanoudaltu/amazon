
select /* query_templates/query09.tpl.0 !CF:IR-c4b99a30-f08a-11e9-b661-06872b3fecc8..stream-query.streams-0005.i0009.1.0:CF! */ case when (select count(*) 
                  from public.store_sales 
                  where ss_quantity between 1 and 20) > 4280239329
            then (select avg(ss_ext_discount_amt) 
                  from public.store_sales 
                  where ss_quantity between 1 and 20) 
            else (select avg(ss_net_paid)
                  from public.store_sales
                  where ss_quantity between 1 and 20) end bucket1 ,
       case when (select count(*)
                  from public.store_sales
                  where ss_quantity between 21 and 40) > 1939989622
            then (select avg(ss_ext_discount_amt)
                  from public.store_sales
                  where ss_quantity between 21 and 40) 
            else (select avg(ss_net_paid)
                  from public.store_sales
                  where ss_quantity between 21 and 40) end bucket2,
       case when (select count(*)
                  from public.store_sales
                  where ss_quantity between 41 and 60) > 746558139
            then (select avg(ss_ext_discount_amt)
                  from public.store_sales
                  where ss_quantity between 41 and 60)
            else (select avg(ss_net_paid)
                  from public.store_sales
                  where ss_quantity between 41 and 60) end bucket3,
       case when (select count(*)
                  from public.store_sales
                  where ss_quantity between 61 and 80) > 1888038883
            then (select avg(ss_ext_discount_amt)
                  from public.store_sales
                  where ss_quantity between 61 and 80)
            else (select avg(ss_net_paid)
                  from public.store_sales
                  where ss_quantity between 61 and 80) end bucket4,
       case when (select count(*)
                  from public.store_sales
                  where ss_quantity between 81 and 100) > 1689737062
            then (select avg(ss_ext_discount_amt)
                  from public.store_sales
                  where ss_quantity between 81 and 100)
            else (select avg(ss_net_paid)
                  from public.store_sales
                  where ss_quantity between 81 and 100) end bucket5
from public.reason
where r_reason_sk = 1
;
